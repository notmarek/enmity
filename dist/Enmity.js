try{Promise.resolve().then(function(){return Assets$2}).then(()=>{Promise.resolve().then(function(){return index$1}).then(a=>{a.initialize()})})}catch(error){alert(`Enmity failed to initialize: ${error.message}`),console.error(error)}const modules$1={Constants:{props:["ActionTypes"]},Clipboard:{props:["setString","getString"]},Assets:{props:["registerAsset"]},Messages:{props:["receiveMessage","sendMessage"]},Clyde:{props:["createBotMessage"]},Avatars:{props:["BOT_AVATARS"]},Native:{props:["NativeModules"],export:"NativeModules"},React:{props:["createElement"]},Dispatcher:{props:["dirtyDispatch"]},Storage:{props:["getItem"]},Toasts:{props:["open","close"],ensure:a=>!a.openLazy&&!a.startDrag&&!a.init&&!a.openReplay&&!a.setAlwaysOnTop},Dialog:{props:["show","openLazy","close"]},Token:{props:["getToken"]},REST:{props:["getAPIBaseURL"]},Settings:{props:["watchKeys"]},Users:{props:["getCurrentUser"]},Navigation:{props:["pushLazy"]},NavigationNative:{props:["NavigationContainer"]},NavigationStack:{props:["createStackNavigator"]},Theme:{props:["theme"]},Linking:{props:["openURL"]},StyleSheet:{props:["createThemedStyleSheet"]},ColorMap:{props:["ThemeColorMap"]},Components:{multiple:!0,props:{Forms:["Form","FormSection"],General:["Button","Text","View"]}},Locale:{props:["Messages"]},Profiles:{props:["showUserProfile"]},Lodash:{props:["debounce","throttle"]},Logger:{name:"Logger"},Flux:{props:[["Store","connectStores"],["useStateFromStoresObject"]]},SVG:{props:["Svg"]},Scenes:{name:"getScreens",default:!1},Moment:{props:["isMoment"]}},common={},blacklist=[],filters={byProps:(...a)=>b=>a.every(a=>void 0!==b[a]),byName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.name===a),byTypeName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.type?.name===a),byDisplayName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.name===a)},getters=[];Object.entries(modules$1).map(([a,b])=>{if(b.multiple)Object.entries(b.props).map(([b,c])=>{getters.push({id:b,filter(a){let b=filters.byProps(...c)(a);return b},submodule:a})});else if(b.props){if(b.props.every(a=>Array.isArray(a))){let c=[];getters.push({id:a,filter(a){let d=b.props.some(b=>b.every(b=>a[b]));return(!d||!b.ensure||!!b.ensure(a))&&(d&&c.push(a),d)},map:Object.assign({},...c)})}else getters.push({id:a,filter(a){let c=filters.byProps(...b.props)(a);return(!c||!b.ensure|| !1!==b.ensure(a))&&c},map:b.export})}else b.displayName?getters.push({id:a,filter:filters.byDisplayName(b.displayName,b.default),map:b.export}):b.name?getters.push({id:a,filter:filters.byName(b.name,b.default),map:b.export}):b.filter&&getters.push({id:a,filter:b.filter,map:b.export})});const results=bulk(...getters.map(({filter:a})=>a));function getModule(a,{all:b=!1,traverse:c=!1,defaultExport:d=!0}={}){if("function"!=typeof a)return null;let e=[],f=function(b,c){try{return a(b,c)}catch{return!1}},g=common.Locale&&common.Locale.getLocale();for(let h in modules){if(blacklist.includes(h))continue;if(!modules[h].isInitialized)try{__r(h)}catch(i){blacklist.push(h);continue}common.Moment&&g&&common.Moment.locale(g);let j=modules[h].publicModule.exports;if(!j||j===window||null===j.ihateproxies){blacklist.push(h);continue}if("object"==typeof j){if(f(j,h)){if(!b)return j;e.push(j)}if(j.default&&f(j.default,h)){let k=d?j.default:j;if(!b)return k;e.push(k)}if(c&&j.__esModule){for(let l in j)if(void 0!==j[l]&&f(j[l],h)){if(!b)return j[l];e.push(j[l])}}}else if("function"==typeof j){if(!f(j,h))continue;if(!b)return j;e.push(j)}}return b?e:e[0]}function getModules(a){return getModule(a,{all:!0})}function bulk(...a){let b=Array(a.length),c=a.map(a=>b=>{try{return a(b)}catch{return!1}});return getModule(d=>{for(let e=0;e<c.length;e++){let f=c[e];"function"==typeof f&&f(d)&&null==b[e]&&(b[e]=d)}return b.filter(String).length===a.length}),b}function getByProps(...a){let[b,{bulk:c=!1,...d}]=parseOptions(a);if(c){let e=b.map(a=>Array.isArray(a)?filters.byProps(...a):filters.byProps(a)).concat({...d});return bulk(...e)}return getModule(filters.byProps(...b),d)}function getByDisplayName(...a){let[b,{bulk:c=!1,default:d=!0,...e}]=parseOptions(a);if(c){let f=b.map(filters.byDisplayName).concat({defaultExport:d,...e});return bulk(...f)}return getModule(filters.byDisplayName(b[0]),{defaultExport:d,...e})}function getByTypeName(...a){let[b,{bulk:c=!1,default:d=!0,...e}]=parseOptions(a);if(c){let f=b.map(filters.byTypeName).concat({defaultExport:d,...e});return bulk(...f)}return getModule(filters.byTypeName(b[0]),{defaultExport:d,...e})}function getByName$1(...a){let[b,{bulk:c=!1,default:d=!0,...e}]=parseOptions(a);if(c){let f=b.map(filters.byName).concat({defaultExport:d,...e});return bulk(...f)}return getModule(filters.byName(b[0]),{defaultExport:d,...e})}function getByKeyword(...a){let[[b],{caseSensitive:c=!1,all:d=!1,...e}]=parseOptions(a);return getModule(a=>{let d=[...Object.keys(a),...Object.keys(a.__proto__)];for(let e=0;e<d.length;e++){let f=d[e];if(c){if(~f.indexOf(b))return!0}else{let g=b.toLowerCase();if(~f.toLowerCase().indexOf(g))return!0}}return!1},{all:d,...e})}function parseOptions(a,b=a=>"object"==typeof a&&!Array.isArray(a)){return[a,b(a[a.length-1])?a.pop():{}]}getters.map(({id:a,map:b,submodule:c},d)=>{let e=a=>a;if("string"==typeof b)e=a=>a[b];else if(Array.isArray(b)){let f={};e=a=>{for(let c of b)f[c]=a[c];return f}}if(!results[d])return;let g=e(results[d]);c?(common[c]??={},common[c][a]=g):common[a]=g});var Type,ApplicationCommandSectionType,ApplicationCommandType,ApplicationCommandInputType,ApplicationCommandPermissionType,ApplicationCommandOptionType,InteractionTypes,Times,Modules=Object.freeze({__proto__:null,common:common,blacklist:blacklist,filters:filters,getModule:getModule,getModules:getModules,bulk:bulk,getByProps:getByProps,getByDisplayName:getByDisplayName,getByTypeName:getByTypeName,getByName:getByName$1,getByKeyword:getByKeyword});const{Clipboard,Assets:Assets$3,Messages,Clyde:Clyde$1,Avatars,Native,Dispatcher,Storage,Toasts,Dialog,Token,REST,Settings:Settings$3,Users,Theme,Linking,StyleSheet:StyleSheet$1,ColorMap,Components:Components$1,Locale,Constants,Profiles,Logger:Logger$1,Lodash,Flux,SVG,Scenes,Navigation,NavigationNative,NavigationStack,Moment}=common;common.React;const patches=[];function getPatchesByCaller(a){if(!a)return[];let b=[];for(let c of patches){let d=[...c.patches.before,...c.patches.instead,...c.patches.after];for(let e of d)e.caller===a&&b.push(e)}return b}function unpatchAll(a){let b=getPatchesByCaller(a);if(b.length)for(let c of b)c.unpatch()}function override(a){return function(){if(!a?.patches?.before.length&&!a?.patches?.after.length&&!a?.patches?.instead.length&&!patches.find(b=>b.mdl===a.mdl&&b.func===a.func))return a.unpatch(),new.target?new a.original(...arguments):a.original.apply(this,arguments);let b,c=arguments,d=a.patches.before;for(let e=0;e<d.length;e++){let f=d[e];if(f)try{let g=f.callback(this,c,a.original.bind(this));Array.isArray(g)&&(c=g),f.once&&f.unpatch()}catch(h){console.error(`Could not fire before patch for ${a.func} of ${f.caller}`),console.error(h)}}let i=a.patches.instead;if(i.length)for(let j=0;j<i.length;j++){let k=i[j];if(k)try{let l=k.callback(this,c,a.original.bind(this));void 0!==l&&(b=l),k.once&&k.unpatch()}catch(m){console.error(`Could not fire instead patch for ${a.func} of ${k.caller}`),console.error(m)}}else b=new.target?new a.original(...c):a.original.apply(this,c);let n=a.patches.after;for(let o=0;o<n.length;o++){let p=n[o];if(p)try{let q=p.callback(this,c,b,a=>b=a);void 0!==q&&(b=q),p.once&&p.unpatch()}catch(r){console.error(`Could not fire after patch for ${a.func} of ${p.caller}`),console.error(r)}}return b}}function push([,a,b,,c,d]){let e={mdl:a,func:b,id:patches?.[c]?.length??0,original:a[b],once:d,unpatch(){e.mdl[e.func]=e.original,e.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}};a[b]=override(e);let f=Object.getOwnPropertyDescriptors(e.original);return delete f.length,Object.defineProperties(a[b],{...f,toString:{value:()=>e.original.toString(),configurable:!0,enumerable:!1},__original:{value:e.original,configurable:!0,enumerable:!1}}),patches.push(e),e}function get$2([,a,b]){let c=patches.find(c=>c.mdl===a&&c.func===b);return c||push(...arguments)}function patch(a,b,c,d,e=Type.After,f=!1){if(a&&"string"==typeof a){if(b&&["function","object"].includes(typeof b)){if(c&&"string"==typeof c){if(d&&"function"==typeof d){if(e&&"string"==typeof e&&["after","before","instead"].includes(e)){if(void 0===b[c])throw ReferenceError(`function ${c} does not exist on the second argument (object or function)`)}else throw TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead')}else throw TypeError('fourth argument "callback" must be of type function')}else throw TypeError('third argument "func" must be of type string')}else throw TypeError('second argument "mdl" must be of type function or object')}else throw TypeError('first argument "caller" must be of type string');let g=get$2(arguments),h={caller:a,once:f,type:e,id:g.patches?.[e]?.length??0,callback:d,unpatch(){let a=g.patches?.[e].findIndex(a=>a.id===h.id);if(~a&&g.patches?.[e].splice(a,1),g.patches?.before.length||g.patches?.after.length||g.patches?.instead.length)return;let d=patches.findIndex(a=>a.mdl==b&&a.func==c);d&&(patches[d]?.unpatch(),patches.splice(d,1))}};return g.patches[e]??=[],g.patches[e].push(h),h.unpatch}function before(a,b,c,d,e=!1){return patch(a,b,c,d,Type.Before,e)}function instead(a,b,c,d,e=!1){return patch(a,b,c,d,Type.Instead,e)}function after(a,b,c,d,e=!1){return patch(a,b,c,d,Type.After,e)}function create(a){return{getPatchesByCaller:getPatchesByCaller,before:(b,c,d)=>before(a,b,c,d),instead:(b,c,d)=>instead(a,b,c,d),after:(b,c,d)=>after(a,b,c,d),unpatchAll:()=>unpatchAll(a)}}!function(a){a.Before="before",a.Instead="instead",a.After="after"}(Type||(Type={}));var Patcher$4={create,before,instead,after,unpatchAll,patches},Patcher$5=Object.freeze({__proto__:null,create:create,before:before,instead:instead,after:after,unpatchAll:unpatchAll,patches:patches,default:Patcher$4});const assets={};try{Patcher$4.after("enmity-assets",Assets$3,"registerAsset",(a,[b],c)=>{assets[b.name]={...b,id:c}});for(let id=1;;id++){let asset=Assets$3.getAssetByID(id);if(!asset)break;assets[asset.name]||(assets[asset.name]={...asset,id})}}catch{}function find(a){return Object.values(assets).find(a)}function getByName(a){return assets[a]}function getByID(a){return Assets$3.getAssetByID(a)}function getIDByName(a){return assets[a]?.id}var Assets$1={assets,getByName,getByID,getIDByName},Assets$2=Object.freeze({__proto__:null,assets:assets,find:find,getByName:getByName,getByID:getByID,getIDByName:getIDByName,default:Assets$1});const settings=Settings$3.get("enmity")??{};function getSetting(a,b,c){return settings[a]?.[b]??c}function get$1(a){return settings[a]??{}}function getAll(){return settings}const Events$2={ENMITY_GET_SETTING:({file:a,setting:b,defaults:c})=>settings[a][b]??c,ENMITY_SET_SETTING({file:a,setting:b,value:c}){settings[a]||(settings[a]={}),void 0==c?delete settings[a][b]:settings[a][b]=c},ENMITY_TOGGLE_SETTING({file:a,setting:b,defaults:c}){settings[a]||(settings[a]={}),void 0===settings[a][b]?settings[a][b]=!Boolean(c):settings[a][b]=!Boolean(settings[a][b])}},store=new Flux.Store(Dispatcher,Events$2);store.addChangeListener(Lodash.debounce(()=>Settings$3.set({enmity:settings}),200));var Manager={store,getAll,getSetting,get:get$1},React=common.React;const listeners={};function ENMITY_SET_SETTING(a){return handleSettingsUpdate({...a,type:"set"})}function ENMITY_TOGGLE_SETTING(a){return handleSettingsUpdate({...a,type:"toggle"})}function handleSettingsUpdate({file:a,type:b,...c}){let d=listeners[a];if(d)for(let e of d.values())e({...c})}function set(a,b,c){if(a&&"string"==typeof a){if(!b||"string"!=typeof b)throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_SET_SETTING",file:a,setting:b,value:c})}function get(a,b,c){if(a&&"string"==typeof a){if(!b||"string"!=typeof b)throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Manager.getSetting(a,b,c)}function getBoolean(a,b,c){if(a&&"string"==typeof a){if(b&&"string"==typeof b){if(void 0===c||"boolean"!=typeof c)throw TypeError("the third argument defaults must be of type boolean")}else throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Boolean(Manager.getSetting(a,b,c))}function toggle(a,b,c){if(a&&"string"==typeof a){if(b&&"string"==typeof b){if(void 0===c||"boolean"!=typeof c)throw TypeError("the third argument defaults must be of type boolean")}else throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_TOGGLE_SETTING",file:a,setting:b,defaults:c})}function connectComponent(a,b){if(a&&["function","object"].includes(typeof a)){if(!b||"string"!=typeof b)throw TypeError("the second argument file must be of type string")}else throw TypeError("the first argument component must be of type function or object");let c=c=>{let d=React.useState({})[1];return React.useEffect(()=>{function a(){d({})}return subscribe(b,a),()=>unsubscribe(b,a)},[]),React.createElement(a,{...c,settings:makeStore(b)})};return a.displayName&&(c.displayName=a.displayName),a.name&&(c.name=`Connected${a.name}`),c}function makeStore(a){if(!a||"string"!=typeof a)throw TypeError("the first argument file must be of type string");return{settings:Manager.get(a),set:(b,c)=>set(a,b,c),get:(b,c)=>get(a,b,c),toggle:(b,c)=>toggle(a,b,c),getBoolean:(b,c)=>getBoolean(a,b,c)}}function subscribe(a,b){if(a&&"string"==typeof a){if(!b||"function"!=typeof b)throw TypeError("the second argument callback must be of type function")}else throw TypeError("the first argument file must be of type string");listeners[a]??=new Set,listeners[a].add(b)}function unsubscribe(a,b){if(a&&"string"==typeof a){if(!b||"function"!=typeof b)throw TypeError("the second argument callback must be of type function")}else throw TypeError("the first argument file must be of type string");listeners[a]?.delete(b),listeners[a]?.size===0&&delete listeners[a]}function connectStores(a,b){if(a&&["function","object"].includes(typeof a)){if(!b||"string"!=typeof b)throw TypeError("the second argument file must be of type string")}else throw TypeError("the first argument component must be of type function or object");return Flux.connectStores([Manager.store],()=>({settings:makeStore(b)}))(a)}Dispatcher.subscribe("ENMITY_SET_SETTING",ENMITY_SET_SETTING),Dispatcher.subscribe("ENMITY_TOGGLE_SETTING",ENMITY_TOGGLE_SETTING);var Settings$1={connectComponent,connectStores,unsubscribe,subscribe,makeStore,listeners,toggle,get,set},Settings$2=Object.freeze({__proto__:null,listeners:listeners,set:set,get:get,getBoolean:getBoolean,toggle:toggle,connectComponent:connectComponent,makeStore:makeStore,subscribe:subscribe,unsubscribe:unsubscribe,connectStores:connectStores,default:Settings$1,settings:settings,store:store});const Logger=getByName$1("Logger"),EnmityLogger=new Logger("Enmity");let socket;function connectWebsocket(host){console.log("Connecting to debug WebSocket"),void 0!==socket&&socket.readyState!==WebSocket.CLOSED&&(socket.close(),socket=null);let address=Boolean(Settings$1.get("enmity","autoConnectWS",!1))&&Settings$1.get("enmity","debugWSAddress");(address||host)&&((socket=new WebSocket(`ws://${host??address}`)).addEventListener("open",()=>{console.log("Connected with debug websocket"),Toasts.open({content:"Connected to the WebSocket server.",source:getIDByName("Check")})}),socket.addEventListener("error",a=>{console.log(`Error with debug websocket: ${a.message}`),Toasts.open({content:"An error occured with the websocket connection.",source:getIDByName("toast_copy_link")})}),socket.addEventListener("close",a=>{console.log(`Error with debug websocket: ${a.message}`),Toasts.open({content:"The websocket connection has been closed.",source:getIDByName("toast_copy_link")})}),socket.addEventListener("message",message=>{try{console.log(eval(message.data))}catch(e){console.error(e)}}))}function initialize$5(){let a=nativeLoggingHook;globalThis.nativeLoggingHook=function(b,c){return socket?.readyState===WebSocket.OPEN&&socket.send(JSON.stringify({level:c,message:b})),EnmityLogger.log(b),a.apply(this,arguments)},Settings$1.get("enmity","autoConnectWS",!1)&&connectWebsocket()}function sendMessage(a){socket?.readyState===WebSocket.OPEN&&socket.send(a)}var WebSocket$1={initialize:initialize$5,sendMessage,connectWebsocket,socket};const{Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList}=Components$1.General,{Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes}=Components$1.Forms;var Components=Object.freeze({__proto__:null,Alert:Alert,Button:Button,FlatList:FlatList,Image:Image,ImageBackground:ImageBackground,KeyboardAvoidingView:KeyboardAvoidingView,Modal:Modal,Pressable:Pressable,RefreshControl:RefreshControl,ScrollView:ScrollView,SectionList:SectionList,StatusBar:StatusBar,StyleSheet:StyleSheet,Switch:Switch,Text:Text,TextInput:TextInput,TouchableHighlight:TouchableHighlight,TouchableOpacity:TouchableOpacity,TouchableWithoutFeedback:TouchableWithoutFeedback,Touchable:Touchable,View:View,VirtualizedList:VirtualizedList,Form:Form,FormArrow:FormArrow,FormCTA:FormCTA,FormCTAButton:FormCTAButton,FormCardSection:FormCardSection,FormCheckbox:FormCheckbox,FormDivider:FormDivider,FormHint:FormHint,FormIcon:FormIcon,FormInput:FormInput,FormLabel:FormLabel,FormRadio:FormRadio,FormRow:FormRow,FormSection:FormSection,FormSelect:FormSelect,FormSubLabel:FormSubLabel,FormSwitch:FormSwitch,FormTernaryCheckBox:FormTernaryCheckBox,FormText:FormText,FormTextColors:FormTextColors,FormTextSizes:FormTextSizes});const Settings=NavigationStack.createStackNavigator(),{ThemeColorMap:ThemeColorMap$6}=ColorMap;function PluginSettings({name:a="hi",children:b=React.createElement(Text,null,"hi")}={}){let c=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_PRIMARY,color:ThemeColorMap$6.TEXT_NORMAL},header:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:ThemeColorMap$6.HEADER_PRIMARY},close:{color:ThemeColorMap$6.HEADER_PRIMARY}});return React.createElement(NavigationNative.NavigationContainer,null,React.createElement(Settings.Navigator,{initialRouteName:a,style:c.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:c.cardStyle,headerStyle:c.header,headerTitleContainerStyle:c.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},React.createElement(Settings.Screen,{name:a,component:b,options:{headerTitleStyle:{color:"white"},headerLeft:()=>React.createElement(Button,{color:c.close.color,title:"Close",onPress:()=>Navigation.pop()}),...NavigationStack.TransitionPresets.ModalSlideFromBottomIOS}})))}!function(a){a[a.BuiltIn=0]="BuiltIn",a[a.Guild=1]="Guild",a[a.DM=2]="DM"}(ApplicationCommandSectionType||(ApplicationCommandSectionType={})),function(a){a[a.Chat=1]="Chat",a[a.User=2]="User",a[a.Message=3]="Message"}(ApplicationCommandType||(ApplicationCommandType={})),function(a){a[a.BuiltIn=0]="BuiltIn",a[a.BuiltInText=1]="BuiltInText",a[a.BuiltInIntegration=2]="BuiltInIntegration",a[a.Bot=3]="Bot",a[a.Placeholder=4]="Placeholder"}(ApplicationCommandInputType||(ApplicationCommandInputType={})),function(a){a[a.Role=1]="Role",a[a.User=2]="User"}(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={})),function(a){a[a.SubCommand=1]="SubCommand",a[a.SubCommandGroup=2]="SubCommandGroup",a[a.String=3]="String",a[a.Integer=4]="Integer",a[a.Boolean=5]="Boolean",a[a.User=6]="User",a[a.Channel=7]="Channel",a[a.Role=8]="Role",a[a.Mentionnable=9]="Mentionnable",a[a.Number=10]="Number",a[a.Attachment=11]="Attachment"}(ApplicationCommandOptionType||(ApplicationCommandOptionType={})),function(a){a[a.ApplicationCommand=2]="ApplicationCommand",a[a.MessageComponent=3]="MessageComponent"}(InteractionTypes||(InteractionTypes={}));const Patcher$3=create("enmity-commands"),[Commands$1,Assets,SearchStore]=bulk(filters.byProps("getBuiltInCommands"),filters.byProps("getApplicationIconURL"),filters.byProps("useSearchManager"));let commands=[];const section={id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"};try{initialize$4()}catch(e){console.error("Failed to patch commands: ",e.message)}function registerCommands(a,b){if(a&&"string"==typeof a){if(!b||!Array.isArray(b))throw TypeError("second argument cmds must be of type array")}else throw TypeError("first argument caller must be of type string");for(let c in b){let d=b[c];b[c]={displayName:d.name,displayDescription:d.description,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,id:`enmity-${d.name.replaceAll(" ","-")}`,applicationId:section.id,...d,__enmity:!0,caller:a}}commands.push(...b)}function unregisterCommands(a){if(!a||"string"!=typeof a)throw TypeError("first argument caller must be of type string");commands=commands.filter(b=>b.caller!==a)}function initialize$4(){Commands$1.BUILT_IN_SECTIONS.enmity=section,Patcher$3.after(SearchStore.default,"getQueryCommands",(a,[,,b],c)=>{if(!(!b||b.startsWith("/"))){for(let d of(c??=[],commands))if(!(!~d.name?.indexOf(b)||c.some(a=>a.__enmity&&a.id===d.id)))try{c.unshift(d)}catch{c=[...c,d]}}}),Patcher$3.instead(SearchStore.default,"getApplicationSections",(a,b,c)=>{try{let d=c.apply(self,b)??[];return d.find(a=>a.id===section.id)||d.push(section),d}catch{return[]}}),Patcher$3.after(SearchStore,"useSearchManager",(a,[,b],c)=>{if(1!==b)return;if(c.sectionDescriptors?.find?.(a=>a.id===section.id)||(c.sectionDescriptors??=[],c.sectionDescriptors.push(section)),c.filteredSectionId&&c.filteredSectionId!==section.id||c.activeSections.find(a=>a.id===section.id)||c.activeSections.push(section),commands.some(a=>!c.commands?.find?.(b=>b.id===a.id))){c.commands??=[];let d=[...c.commands,...commands];c.commands=[...new Set(d).values()]}c.filteredSectionId&&c.filteredSectionId!==section.id||c.commandsByActiveSection.find(a=>a.section.id===section.id)||c.commandsByActiveSection.push({section:section,data:commands});let e=c.commandsByActiveSection.find(a=>a.section.id===section.id);(!c.filteredSectionId||c.filteredSectionId===section.id)&&e&&0===e.data.length&&0!==commands.length&&(e.data=commands);let f=c.sectionDescriptors.filter(a=>"-1"===a.id);f.length>1&&(c.sectionDescriptors=c.sectionDescriptors.filter(a=>"-1"!==a.id),c.sectionDescriptors.push(f.find(a=>"-1"===a.id)))}),Patcher$3.after(Assets,"getApplicationIconURL",(a,[b],c)=>{if("enmity"===b.id)return section.icon})}var Commands$2=Object.freeze({__proto__:null,section:section,registerCommands:registerCommands,unregisterCommands:unregisterCommands});function uuid(a=10){let b="";do{let c=16*Math.random()|0;b+=(12==b.length?4:16==b.length?3&c|8:c).toString(16)}while(b.length<a)return b}const replies={};function sendCommand(a,b=[],c){let d=uuid();Linking.openURL(`com.hammerandchisel.discord://enmity?id=${d}&command=${a}&params=${b.join(",")}`).then(()=>{c&&(replies[d]=c)})}Linking.addEventListener("url",a=>{let b=a.url;b=decodeURIComponent(b.replace("com.hammerandchisel.discord://",""));try{let c=JSON.parse(b);if(void 0===c.data)return;replies[c.id]&&(replies[c.id](c.data),delete replies[c.id])}catch(d){return}});const EventEmitter$1=getByProps("EventEmitter").EventEmitter;let plugins$1=[],enabled=window.plugins.enabled,disabled=window.plugins.disabled;const Events$1=new EventEmitter$1;function registerPlugin(a){a&&"object"==typeof a&&(a.onEnable=()=>{try{a.onStart(),a.commands&&registerCommands(a.name,a.commands),console.log(`${a.name} has been enabled`)}catch(b){console.log(`${a.name} failed to load`,b.message)}},a.onDisable=()=>{try{if(a.patches)for(let b of a.patches)b.unpatchAll();a.commands&&unregisterCommands(a.name),a.onStop(),console.log(`${a.name} has been disabled`)}catch(c){console.log(`${a.name} failed to disable`,c.message)}},enabled.includes(a.name)&&a.onEnable(),disabled.includes(a.name)&&a.onDisable(),getPlugin(a.name)||plugins$1.push(a))}const on$1=Events$1.on.bind(Events$1),once$1=Events$1.once.bind(Events$1),off$1=Events$1.off.bind(Events$1);function getPlugin(a){return plugins$1.find(b=>b.name===a)}function getPlugins(){return plugins$1}function getEnabledPlugins(){return enabled}function getDisabledPlugins(){return disabled}function disablePlugin$1(a,b=!1,c){if(enabled.includes(a)){let d=enabled.indexOf(a);~d&&enabled.splice(d,1)}if(b&&disabled.includes(a)){let e=disabled.indexOf(a);~e&&disabled.splice(e,1)}return b||disabled.push(a),getPlugin(a).onDisable(),new Promise(b=>{sendCommand("disable-plugin",[a],(...a)=>{c&&c(...a),b(...a)})})}function enablePlugin(a,b){if(disabled.includes(a)){let c=disabled.indexOf(a);~c&&disabled.splice(c,1)}return enabled.push(a),getPlugin(a).onEnable(),new Promise(c=>{sendCommand("enable-plugin",[a],(...a)=>{b&&b(...a),c(...a)})})}async function evalPlugin(url,enable=!1,update){try{let response=await REST.get(url),code=response.text,name=url.split("/").pop().split(".")[0],id=Number(Object.keys(window.modules).pop())+1,wrapper=`__d(function(...args) {
        try {
          ${code}
        } catch(err) {
          console.log(err);
        }
      }, ${id}, []);
      __r(${id})`;try{eval(wrapper),enable&&!enabled.includes(name)&&await enablePlugin(name)}catch(e){console.log("Failed to eval plugin instance",e.message)}return update&&update(),name}catch(e){console.log("Failed to eval plugin instance",e.message)}}function installPlugin(a,b,c){let d=a.split("/").pop().split(".")[0];return new Promise(e=>{sendCommand("install-plugin",[a],f=>{function g(){evalPlugin(a,!0).then(d=>{let g={name:d,data:f,url:a};Events$1.emit("installed"),b&&b(g),c(),e(g)})}return"overridden_plugin"===f?disablePlugin$1(d,!0).then(g):g()})})}function uninstallPlugin(a,b){return new Promise(c=>{disablePlugin$1(a),sendCommand("uninstall-plugin",[a],d=>{enabled=enabled.filter(b=>b!==a),disabled=disabled.filter(b=>b!==a);let e=plugins$1.findIndex(b=>b.name===a);e> -1&&plugins$1.splice(e,1),Events$1.emit("uninstalled"),b&&b(d),c(d)})})}var Plugins=Object.freeze({__proto__:null,registerPlugin:registerPlugin,on:on$1,once:once$1,off:off$1,getPlugin:getPlugin,getPlugins:getPlugins,getEnabledPlugins:getEnabledPlugins,getDisabledPlugins:getDisabledPlugins,disablePlugin:disablePlugin$1,enablePlugin:enablePlugin,evalPlugin:evalPlugin,installPlugin:installPlugin,uninstallPlugin:uninstallPlugin});const{ThemeColorMap:ThemeColorMap$5}=ColorMap;function Authors({authors:a}){if(!a||!Array.isArray(a)||!a.length)return null;let b=StyleSheet$1.createThemedStyleSheet({linkless:{color:ThemeColorMap$5.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",fontSize:16,alignItems:"center",alignSelf:"center",justifyContent:"center"},link:{color:ThemeColorMap$5.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",fontSize:16,alignSelf:"center",justifyContent:"center"}});return React.createElement(View,{style:b.container},a.map((c,d)=>{let e=d!==a.length-1;return"string"==typeof c?React.createElement(Text,{style:b.linkless},c,e&&","):"object"==typeof c&&c.name&&!c.id?React.createElement(Text,{style:b.linkless},c.name,e&&","):"object"==typeof c&&c.name&&c.id?React.createElement(TouchableOpacity,{key:c.id,onPress:()=>Profiles.showUserProfile({userId:c.id})},React.createElement(Text,{style:b.link},c.name,e&&",")):null}).filter(Boolean))}const{createThemedStyleSheet:createThemedStyleSheet$1}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$4}=ColorMap;function PluginCard({plugin:a}){let b=getEnabledPlugins(),[c,d]=React.useState(b.includes(a.name)),e=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$4.BACKGROUND_SECONDARY,borderRadius:15,borderLeftColor:a.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$4.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$4.HEADER_SECONDARY,fontSize:16,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5,marginRight:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center",flexWrap:"wrap",width:"100%"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:ThemeColorMap$4.INTERACTIVE_NORMAL},settingsIcon:{width:22,height:22,tintColor:ThemeColorMap$4.INTERACTIVE_NORMAL}}),f=a.getSettingsPanel;return React.createElement(View,{style:e.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:e.info},React.createElement(Text,{adjustsFontSizeToFit:!0,style:e.name},a.name),a.version&&React.createElement(Text,{adjustsFontSizeToFit:!0,style:e.version},a.version," ",a.authors&&"by"),React.createElement(Authors,{authors:a.authors})),trailing:()=>React.createElement(View,{style:e.actions},f&&React.createElement(TouchableOpacity,{style:e.delete,onPress(){Navigation.push(PluginSettings,{name:a.name,children:connectComponent(f,a.name)})}},React.createElement(Image,{style:e.settingsIcon,source:Assets$1.getIDByName("settings")})),a.sourceUrl&&React.createElement(TouchableOpacity,{style:e.delete,onPress(){installPlugin(`${a.sourceUrl}?${101*Math.random()}.js`,()=>{Toasts.show({content:"Plugin updated.",type:"success"})})}},React.createElement(Image,{style:e.trashIcon,source:Assets$1.getIDByName("ic_sync_24px")})),React.createElement(TouchableOpacity,{style:e.delete,onPress:()=>void uninstallPlugin(a.name)},React.createElement(Image,{style:e.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:c,onValueChange(b){d(b),Toasts.open({content:`${a.name} has been ${b?"enabled":"disabled"}.`}),b?enablePlugin(a.name):disablePlugin$1(a.name)}}))})),React.createElement(View,{style:e.content},React.createElement(Text,{style:e.description},a.description??"No description provided.")))}function HeaderRight$2(){let a=createThemedStyleSheet$1({header:{tintColor:ThemeColorMap$4.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:a.wrapper,onPress(){Alert.prompt("Install a plugin","Please enter the URL of the plugin to install.",a=>{if(!a.endsWith("js"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});installPlugin(a,({data:a})=>{let b={icon:null,text:null};switch(a){case"fucky_wucky":b.text="Failed plugin installation.",b.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_plugin":b.text="Plugin has been installed.",b.icon=Assets$1.getIDByName("Check");break;case"overridden_plugin":b.text="Plugin has been overriden.",b.icon=Assets$1.getIDByName("Check")}Toasts.open({content:b.text,source:b.icon})})})}},React.createElement(Image,{style:a.header,source:Assets$1.getIDByName("add_white")}))}const Search$1=getModule(a=>"StaticSearchBarContainer"===a.name);function Page$2(){let a=React.useState(null)[1],[b,c]=React.useState(getPlugins().sort((a,b)=>a.name.localeCompare(b.name))),[d,e]=React.useState(!1),[f,g]=React.useState(null);React.useEffect(()=>{function b(){a({})}return on$1("installed",b),on$1("uninstalled",b),()=>{off$1("installed",b),off$1("uninstalled",b)}},[]);let h=f?b.filter(a=>!!(a.name.toLowerCase().includes(f.toLowerCase())||a.description?.toLowerCase().includes(f.toLowerCase())||a.authors?.find?.(a=>(a.name??a).toLowerCase().includes(f.toLowerCase())))):b,i=createThemedStyleSheet$1({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$4.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search$1,{style:i.search,placeholder:"Search plugins...",onChangeText:a=>g(a)}),React.createElement(View,{style:i.container},React.createElement(ScrollView,{style:i.container,refreshControl:React.createElement(RefreshControl,{refreshing:d,onRefresh(){e(!0),c(getPlugins()),e(!1)}})},h.length?h.map(a=>React.createElement(PluginCard,{plugin:a})):f?React.createElement(View,{style:i.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:i.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...i.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:i.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:i.notFoundText},"You don't have any plugins."),React.createElement(Text,{style:{...i.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}let theme=window.themes?.theme??"",themes$1=window.themes?.list??[];const EventEmitter=getByProps("EventEmitter").EventEmitter,Events=new EventEmitter,on=Events.on.bind(Events),once=Events.once.bind(Events),off=Events.off.bind(Events);function getTheme(){return theme}function getThemeByName(a){return themes$1.find(b=>b.name===a)}function listThemes(){return themes$1}async function installTheme(a,b){return new Promise(c=>{sendCommand("install-theme",[a],d=>{REST.get(a).then(e=>{let f=JSON.parse(e.text);if(!f)throw Error("Invalid theme structure");let g=themes$1.findIndex(a=>a.name===f.name);g> -1&&themes$1.splice(g,1),themes$1.push(f);let h={theme:f,url:a,data:d,restart:getTheme()===f.name};b&&b(h),Events.emit("installed"),c(h)})})})}function applyTheme(a,b){return new Promise(c=>{sendCommand("apply-theme",[a,Theme.theme],d=>{theme=a,b&&b(d),Events.emit("applied",a),c(d)})})}function removeTheme(a){return new Promise(b=>{sendCommand("remove-theme",[],c=>{theme="",a&&a(c),Events.emit("removed"),b(c)})})}async function uninstallTheme(a,b){return getTheme()===a&&removeTheme(),new Promise(c=>{sendCommand("uninstall-theme",[a],d=>{let e=themes$1.findIndex(b=>b.name===a);e> -1&&themes$1.splice(e,1),Events.emit("uninstalled"),b&&b(d),c(d)})})}var Themes=Object.freeze({__proto__:null,on:on,once:once,off:off,getTheme:getTheme,getThemeByName:getThemeByName,listThemes:listThemes,installTheme:installTheme,applyTheme:applyTheme,removeTheme:removeTheme,uninstallTheme:uninstallTheme});const reload=Native.BundleUpdaterManager.reload,version=Native.InfoDictionaryManager.Version,os=Native.DCDDeviceManager.systemVersion,build=Native.InfoDictionaryManager.Build,device=Native.DCDDeviceManager.device,{createThemedStyleSheet}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$3}=ColorMap;function ThemeCard({theme:a}){let b=getTheme(),[c,d]=React.useState(b===a.name),e=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$3.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:a.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$3.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$3.HEADER_SECONDARY,fontSize:16,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5,marginRight:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center",flexWrap:"wrap",width:"100%"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:ThemeColorMap$3.INTERACTIVE_NORMAL}});return React.createElement(View,{style:e.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:e.info},React.createElement(Text,{adjustsFontSizeToFit:!0,style:e.name},a.name),a.version&&React.createElement(Text,{adjustsFontSizeToFit:!0,style:e.version},a.version," ",a.authors&&"by"),React.createElement(Authors,{authors:a.authors})),trailing:()=>React.createElement(View,{style:e.actions},React.createElement(TouchableOpacity,{style:e.delete,onPress(){uninstallTheme(a.name,()=>{c&&Dialog.show({title:"Theme Uninstalled",body:"Uninstalling the theme you previously had applied requires a restart, would you like to restart Discord to remove the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload})})}},React.createElement(Image,{style:e.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:c,onValueChange(b){d(b),Toasts.open({content:`${a.name} has been ${b?"enabled":"disabled"}.`}),b?(applyTheme(a.name),Dialog.show({title:"Theme Applied",body:"Applying a theme requires a restart, would you like to restart Discord to apply the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload})):(removeTheme(),Dialog.show({title:"Theme Removed",body:"Removing the applied theme requires a restart, would you like to restart Discord to remove the applied theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload}))}}))})),React.createElement(View,{style:e.content},React.createElement(Text,{style:e.description},a.description??"No description provided.")))}function HeaderRight$1(){let a=createThemedStyleSheet({header:{tintColor:ThemeColorMap$3.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:a.wrapper,onPress(){Alert.prompt("Install a theme","Please enter the URL of a theme to install.",a=>{if(!a.endsWith("json"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});try{installTheme(a,({data:a,restart:b})=>{let c={icon:null,text:null,restart:!1};switch(a){case"fucky_wucky":c.text="Failed theme installation.",c.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_theme":c.text="Theme has been installed.",c.icon=Assets$1.getIDByName("Check"),c.restart=b;break;case"overridden_theme":c.text="Theme has been overriden.",c.icon=Assets$1.getIDByName("Check"),c.restart=b}if(Toasts.open({content:c.text,source:c.icon}),c.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reload})})}catch(b){Toasts.open({content:b.message})}})}},React.createElement(Image,{style:a.header,source:Assets$1.getIDByName("add_white")}))}const Search=getModule(a=>"StaticSearchBarContainer"===a.name);function Page$1(){let a=React.useState(null)[1],[b,c]=React.useState(listThemes().sort((a,b)=>a.name.localeCompare(b.name))),[d,e]=React.useState(!1),[f,g]=React.useState(null);React.useEffect(()=>{function b(){a({})}return on("installed",b),on("uninstalled",b),()=>{off("installed",b),off("uninstalled",b)}},[]);let h=f?b.filter(a=>!!(a.name.toLowerCase().includes(f.toLowerCase())||a.description?.toLowerCase().includes(f.toLowerCase())||a.authors?.find?.(a=>(a.name??a).toLowerCase().includes(f.toLowerCase())))):b,i=createThemedStyleSheet({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$3.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search,{style:i.search,placeholder:"Search themes...",onChangeText:a=>g(a)}),React.createElement(View,{style:i.container},React.createElement(ScrollView,{style:i.container,refreshControl:React.createElement(RefreshControl,{refreshing:d,onRefresh(){e(!0),c(listThemes()),e(!1)}})},h.length?h.map(a=>React.createElement(ThemeCard,{theme:a})):f?React.createElement(View,{style:i.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:i.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...i.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:i.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:i.notFoundText},"You don't have any themes."),React.createElement(Text,{style:{...i.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}function _extends$1(){return(_extends$1=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$2}=ColorMap;function PluginIcon({height:a,width:b,...c}){let d=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$2.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends$1({viewBox:"0 0 24 24",style:{height:a,width:b,...d.icon},fill:"currentColor"},c),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function _extends(){return(_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$1}=ColorMap;function ThemeIcon({height:a,width:b,...c}){let d=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$1.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends({viewBox:"0 0 24 24",style:{height:a,width:b,...d.icon},fill:"currentColor"},c),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const ThemeColorMap=ColorMap.ThemeColorMap,Invites=getByProps("acceptInviteAndTransitionToInviteChannel");function HeaderRight(){return null}function Page({settings:a}){let b=StyleSheet$1.createThemedStyleSheet({debugText:{color:ThemeColorMap.TEXT_MUTED}}),c={Twitter:getIDByName("img_account_sync_twitter_white"),GitHub:getIDByName("img_account_sync_github_white"),Addon:getIDByName("img_nitro_increase_guild_limit"),Checkmark:getIDByName("Check"),Discord:getIDByName("Discord"),Refresh:getIDByName("ic_sync_24px")},d=[...window.plugins.enabled,...window.plugins.disabled],e=listThemes().map(a=>a.name);return React.createElement(ScrollView,null,React.createElement(KeyboardAvoidingView,{enabled:!0,behavior:"position",style:b.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React.createElement(FormSection,{title:"Links"},React.createElement(FormRow,{label:"Discord Server",leading:React.createElement(FormRow.Icon,{source:c.Discord}),trailing:FormRow.Arrow,onPress:()=>Invites.acceptInviteAndTransitionToInviteChannel("enmityapp")}),React.createElement(FormRow,{label:"GitHub",leading:React.createElement(FormRow.Icon,{source:c.GitHub}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://github.com/enmity-mod")}),React.createElement(FormRow,{label:"Twitter",leading:React.createElement(FormRow.Icon,{source:c.Twitter}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://twitter.com/EnmityApp")})),React.createElement(FormSection,{title:"Debug"},React.createElement(FormRow,{label:"Discord Version",leading:React.createElement(FormRow.Icon,{source:c.Discord}),trailing:()=>React.createElement(Text,{style:b.debugText},version),onPress(){Toasts.open({content:"Copied to clipboard",source:c.Checkmark}),Clipboard.setString(version)}}),React.createElement(FormRow,{label:"Enmity Version",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:()=>React.createElement(Text,{style:b.debugText},window.enmity.version),onPress:()=>Linking.openURL(`https://github.com/enmity-mod/enmity/commit/${window.enmity.version}`)}),React.createElement(FormRow,{label:"Installed Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:b.debugText},d.length),onPress(){Toasts.open({content:"Copied to clipboard",source:c.Checkmark}),Clipboard.setString(`**Plugins**: ${d.join(", ")}`)}}),React.createElement(FormRow,{label:"Installed Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:b.debugText},e.length),onPress(){Toasts.open({content:"Copied to clipboard",source:c.Checkmark}),Clipboard.setString(`**Themes**: ${e.join(", ")}`)}}),React.createElement(FormRow,{label:"Reload Discord",leading:React.createElement(FormRow.Icon,{source:c.Refresh}),onPress(){Dialog.show({title:"Are You Sure?",body:"Are you sure you want to reload the discord app? This might crash your app instead of reloading it.",confirmText:"Yes",cancelText:"No",onConfirm:reload})}}),React.createElement(FormRow,{label:"Automatically connect to debug websocket",trailing:React.createElement(FormSwitch,{value:a.getBoolean("autoConnectWS",!1),onValueChange(){a.toggle("autoConnectWS",!1),a.get("autoConnectWS",!1)?connectWebsocket():socket.close()}})}),a.getBoolean("autoConnectWS",!1)&&React.createElement(FormInput,{value:a.get("debugWSAddress","192.168.0.1:9090"),onChange:b=>a.set("debugWSAddress",b),title:"DEBUG IP"}))))}const Patcher$2=create("enmity-settings");function patchSettings(){patchScreens(),patchSettings$1()}function patchScreens(){Patcher$2.after(Scenes,"default",(a,b,c)=>({...c,Enmity:{key:"Enmity",title:"Enmity",render:connectComponent(Page,"enmity"),headerRight:HeaderRight},EnmityPlugins:{key:"EnmityPlugins",title:"Plugins",render:Page$2,headerRight:HeaderRight$2},EnmityThemes:{key:"EnmityThemes",title:"Themes",render:Page$1,headerRight:HeaderRight$1}}))}function patchSettings$1(){let a=getByTypeName("UserSettingsOverviewWrapper",{default:!1}),b=Patcher$2.after(a,"default",(a,c,d)=>{Patcher$2.after(d.type.prototype,"render",({props:{navigation:a}},b,c)=>{let{children:d}=c.props,e=[Locale.Messages.BILLING_SETTINGS,Locale.Messages.PREMIUM_SETTINGS],f=d.findIndex(a=>e.includes(a.props.title));d.splice(-1===f?4:f,0,React.createElement(React.Fragment,null,React.createElement(FormSection,{key:"Enmity",title:"Enmity"},React.createElement(FormRow,{label:"General",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:React.createElement(FormArrow,null),onPress:()=>void a.push("Enmity",{navigation:a})}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void a.push("EnmityPlugins",{navigation:a})}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void a.push("EnmityThemes",{navigation:a})}),React.createElement(FormDivider,null))))}),b()})}const Patcher$1=create("no-track");function patchTracking(){let[a,b,c]=getByProps(["trackWithMetadata"],["AnalyticsActionHandlers"],["encodeProperties","track"],{bulk:!0});try{patchMetadata(a)}catch(d){console.error("Failed to patch metadata",d.message)}try{patchAnalytics(b)}catch(e){console.error("Failed to patch analytics",e.message)}try{patchProperties(c)}catch(f){console.error("Failed to patch properties",f.message)}return Patcher$1.unpatchAll}function patchMetadata(a){Patcher$1.instead(a,"trackWithMetadata",()=>{}),Patcher$1.instead(a,"trackWithGroupMetadata",()=>{})}function patchAnalytics(a){Patcher$1.instead(a.AnalyticsActionHandlers,"handleTrack",()=>{})}function patchProperties(a){Patcher$1.instead(a,"track",()=>{})}const BadgesDomain="https://raw.githubusercontent.com/notmarek/enmitybadges/main/";function memoize(a){let b;return(...c)=>b??=a.apply(null,c)}function debounce(a,b){let c;return function(...d){clearTimeout(c),c=setTimeout(()=>a.apply(this,d),b)}}function createStore(a){let b={...a??{}},c=uuid().toUpperCase(),d={get:(a,c)=>b[a]??c,set:(a,b)=>Dispatcher.dirtyDispatch({type:`ENMITY_FLUX_${c}_SET`,key:a,value:b}),delete:a=>d.set(a,void 0)},e=new Flux.Store(Dispatcher,{[`ENMITY_FLUX_${c}_SET`]({key:a,value:c}){void 0===c?delete b[a]:b[a]=c}});return{...d,store:e,storage:b,id:c}}function findInTree(a={},b=a=>a,{ignore:c=[],walkable:d=[],maxProperties:e=100}={}){let f=[a],g=function(...a){try{return Reflect.apply(b,this,a)}catch{return!1}};for(;f.length&&e;){let h=f.shift();if(g(h))return h;if(Array.isArray(h))f.push(...h);else if("object"==typeof h&&null!==h){if(d.length)for(let i in h){let j=h[i];~d.indexOf(i)&&!~c.indexOf(i)&&f.push(j)}else for(let k in h){let l=h[k];h&& ~c.indexOf(k)||f.push(l)}}e--}}function findInReactTree(a,b=a=>a,c={}){return findInTree(a,b,{walkable:["props","children"],...c})}!function(a){a[a.HOUR=36e5]="HOUR"}(Times||(Times={}));const{PixelRatio}=Components$1.General;function normalizeSize(a){return PixelRatio.getPixelSizeForLayoutSize(a)}const overrides={useMemo:a=>a(),useState:a=>[a,()=>void 0],useReducer:a=>[a,()=>void 0],useEffect(){},useLayoutEffect(){},useRef:()=>({current:null}),useCallback:a=>a},keys=Object.keys(overrides);var wrapInHooks=a=>(...b)=>{let c=React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher.current,d=keys.map(a=>[a,c[a]]);Object.assign(c,overrides);let e={rendered:null,error:null};try{e.rendered=a(...b)}catch(f){e.error=f}if(Object.assign(c,Object.fromEntries(d)),e.error)throw e.error;return e.rendered};function sleep(a){return new Promise(b=>setTimeout(b,a))}var Utilities=Object.freeze({__proto__:null,memoize:memoize,debounce:debounce,createStore:createStore,findInReactTree:findInReactTree,normalizeSize:normalizeSize,wrapInHooks:wrapInHooks,findInTree:findInTree,sleep:sleep,uuid:uuid});const Patcher=create("badges"),cache={user:{},badges:{}};function patchBadges(){let a=getByDisplayName("ProfileBadges",{default:!1});return Patcher.after(a,"default",(b,[{user:c,isEnmity:d,...e}],f)=>{if(d)return;let[g,h]=React.useState([]);return React.useEffect(()=>{try{fetchUserBadges(c.id).then(h)}catch(a){console.error(`Failed to request/parse badges for ${c.id}`)}},[]),g.length&&(f||((f=wrapInHooks(a.default)({user:new Proxy({},{get:(a,b)=>"flags"===b?-1:c[b]}),isEnmity:!0,...e})).props.badges=[]),f.props.badges.push(...g.map(a=>React.createElement(View,{key:a,__enmity:!0,style:{alignItems:"center",flexDirection:"row",justifyContent:"flex-end"}},React.createElement(Badge,{type:a}))))),f}),Patcher.unpatchAll}async function fetchUserBadges(a){if(cache.user[a]?.date&&Date.now()-cache.user[a].date<Times.HOUR)return cache.user[a].badges;let b=await fetch(BadgesDomain+a+".json",{headers:{"Cache-Control":"no-cache"}}).then(a=>a.json()).catch(()=>[]);return Array.isArray(b)&&(cache.user[a]={badges:b,date:Date.now()}),b}function Badge({type}){let[badge,setBadge]=React.useState(null);return(React.useEffect(()=>{try{fetchBadge(type).then(setBadge)}catch(a){console.error(`Failed to get badge data for ${type}.`,a.message)}},[]),badge?.url)?React.createElement(TouchableOpacity,{onPress(){try{eval(badge.script||"console.log('Badge has no script specified.');")}catch(e){console.log(e.message)}Toasts.open({content:badge.name,source:{uri:badge.url[Theme.theme]}})}},React.createElement(Image,{source:{uri:badge.url[Theme.theme]},style:{width:24,height:24,resizeMode:"contain",marginHorizontal:2}})):null}async function fetchBadge(a){let b=await fetch(BadgesDomain+`data/${a}.json`,{headers:{"Cache-Control":"no-cache"}}).then(a=>a.json()).catch(()=>{});return b?.url&&(cache.badges[a]={data:b,date:Date.now()}),b}function initialize$3(){try{patchSettings()}catch(a){console.log("Failed to patch settings: ",a.message)}try{patchTracking()}catch(b){console.log("Failed to patch trackers: ",b.message)}try{patchBadges()}catch(c){console.log("Failed to patch badges: ",c.message)}}var CorePatches={initialize:initialize$3};try{Avatars.BOT_AVATARS.ENMITY="https://github.com/enmity-mod.png"}catch{}function sendReply(a,b,c,d){let e=Clyde$1.createBotMessage(a,"");e.author.username=c??"Enmity",e.author.avatar=d?c:"ENMITY",d&&(Avatars.BOT_AVATARS[c]=d),"string"==typeof b?e.content=b:Object.assign(e,b),Messages.receiveMessage(a,e)}var Clyde=Object.freeze({__proto__:null,sendReply:sendReply}),plugins=[{name:"plugins list",description:"List installed plugins",execute(a,b){let c=b.channel.id,d=getPlugins();if(0===d.length){sendReply(c,"No plugins installed.");return}let e=getEnabledPlugins(),f=getDisabledPlugins(),g="";e.length>0&&(g=`**Enabled plugins (${e.length})**:
`,g+=`> ${e.join(", ")}
`),f.length>0&&(g+=`**Disabled plugins (${f.length})**:
`,g+=`> ${f.join(", ")}`),sendReply(c,g)}},{name:"plugins install",description:"Install a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin url",displayDescription:"Plugin url",required:!0,type:ApplicationCommandOptionType.String},],execute(a,b){let c=a[0].value,d=b.channel.id;installPlugin(c,a=>{sendReply(d,a)})}},{name:"plugins uninstall",description:"Uninstall a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;uninstallPlugin(c,a=>{sendReply(d,a)})}},{name:"plugins disable",description:"Disable a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;disablePlugin(c,a=>{if("yes"===a){sendReply(d,`**${c}** has been disabled.`);return}sendReply(d,`Error when disabling **${c}**.`)})}},{name:"plugins enable",description:"Enable a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;enablePlugin(c,a=>{if("yes"===a){sendReply(d,`**${c}** has been enabled.`);return}sendReply(d,`Error when enabling **${c}**.`)})}}],themes=[{name:"themes list",description:"List available themes",execute(a,b){let c=listThemes();if(0===c.length){sendReply(b.channel.id,"No themes installed.");return}sendReply(b.channel.id,`**Installed themes (${c.length})**: ${c.map(a=>a.name).join(", ")}`)}},{name:"themes apply",description:"Apply a theme",options:[{name:"name",displayName:"name",description:"Theme's name",displayDescription:"Theme's name",type:ApplicationCommandOptionType.String,required:!0,choices:listThemes().map(a=>({name:a.name,displayName:a.name,value:a.name}))},],execute(a,b){let c=a[0].value,d=getThemeByName(c);d||sendReply(b.channel.id,"Theme couldn't be found."),applyTheme(c).then(a=>{sendReply(b.channel.id,a)})}},{name:"themes clear",description:"Remove applied theme",execute(a,b){removeTheme().then(a=>{sendReply(b.channel.id,a)})}}],utils=[{name:"debug",description:"Print out your device information",execute(a,b){let c=[];c.push("**Debug Info:**"),c.push(`> Enmity: ${window.enmity.version}`),c.push(`> Discord: ${version} (${build})`),c.push(`> Device: ${device}`),c.push(`> System: ${os}`),Messages.sendMessage(b.channel.id,{validNonShortcutEmojis:[],content:c.join("\n")})}},{name:"reload",description:"Reload Discord",execute:reload},{name:"token",description:"Show your Discord's token",execute:function(a,b){sendReply(b.channel.id,Token.getToken())}},],websocket=[{name:"websocket",description:"Connect to the websocket server",options:[{name:"host",displayName:"host",description:"Host of the debugger",displayDescription:"Host of the debugger",type:ApplicationCommandOptionType.String,required:!0},],execute(a){let b=a[0].value;connectWebsocket(b)}},{name:"dump",description:"Dump Discord's modules",execute(a,b){let c=b.channel.id,d=window.modules;function e(a){if("function"==typeof a)return a.toString();if(Array.isArray(a))return a.map(e);if("object"==typeof a){let b={};for(let c in a)b[c]=e(a[c]);return b}return a}for(let f of Object.keys(d))try{let g=d[f],h={id:f};if(!g.publicModule?.exports)continue;let i=g.publicModule.exports;for(let j of Object.keys(g.publicModule.exports))h[j]=e(i[j]);sendMessage(JSON.stringify(h,null,"	"))}catch(k){console.log(`Couldn't dump module ${f}`),console.log(k)}sendReply(c,"Modules has been dumped.")}},];function initialize$2(){let a=[...plugins,...websocket,...utils,...themes,];registerCommands("enmity",a)}var Commands={initialize:initialize$2};const API={modules:Modules,themer:Themes,patcher:Patcher$5,version:"3c38900",plugins:Plugins,clyde:Clyde,commands:Commands$2,utilities:Utilities,settings:Settings$2,components:Components,native:Native,assets:Assets$2};function initialize$1(){window.enmity=API}var API$1={API,initialize:initialize$1};function initialize(){WebSocket$1.initialize(),API$1.initialize(),CorePatches.initialize(),Commands.initialize()}var index={initialize},index$1=Object.freeze({__proto__:null,initialize:initialize,default:index})
